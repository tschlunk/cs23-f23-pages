<!DOCTYPE html>
<html lang="en">
  <head>
  <!-- head.html; common header items for all layouts -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">



<link rel="stylesheet" href="/f23/assets/css/main.css">
  
<script
   src="https://code.jquery.com/jquery-3.3.1.min.js"
   integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
   crossorigin="anonymous"></script>

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">



<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/mousetrap/1.4.6/mousetrap.min.js"></script>


<script src="/f23/assets/js/site.js"></script>

<script>
var nav ={
    
    "offerings": {
	"title" : "F23",
	"url" : "/",
	"baseurl" : "/f23",
	"items" : [
	    
	    {
		"title" : "F23",
		"url" : "/",
		"baseurl" : "/f23",
	    },
	    
	],
    },
    
    
    "offering_links": [
	
		{
		    "title": "PA",		    
		     "url": "/pa_list/", 		    
		     "description": "Programming Assignments", 
		    		    
		},
	
		{
		    "title": "Lab",		    
		     "url": "/lab_list/", 		    
		     "description": "Lab Assignments", 
		    		    
		},
	
		{
		    "title": "Cal",		    
		     "url": "/info/calendar/", 		    
		     "description": "Assignment Calendar", 
		    		    
		},
	
		{
		    "title": "More",		    
		    		    
		    
		    
		    "dropdown" : [
			
			{
			    "title": "Syllabus",		    
			    "url": "/info/syllabus/", 
			     "description": "Syllabus", 
			},
			
			{
			    "title": "Info Pages",		    
			    "url": "/info_list/", 
			     "description": "List of General Information Pages", 
			},
			
		    ]
		    		    
		},
	
		{
		    "title": "Links",		    
		    		    
		    
		    
		    "dropdown" : [
			
			{
			    "title": "Gauchospace",		    
			    "url": "https://gauchospace.ucsb.edu", 
			     "description": "Overall Grade Information", 
			},
			
			{
			    "title": "GradeScope",		    
			    "url": "https://gradescope.com", 
			     "description": "HW and Lab Grades", 
			},
			
			{
			    "title": "Piazza",		    
			    "url": "https://piazza.com", 
			     "description": "Q&A Forum", 
			},
			
		    ]
		    		    
		},
	
		{
		    "title": "Github",		    
		    		    
		    
		    
		    "dropdown" : [
			
			{
			    "title": "ucsb-cs24-f23",		    
			    "url": "https://github.com/ucsb-cs24-f23", 
			    
			},
			
		    ]
		    		    
		},
	
     
    ],
    
        
}
;
</script>





 
  <title> Lect04 |  CS24 Fall 2023</title>
  </head>
  <body id="page-top">
    
    <div id="container" data-role="page">
    

<script>
  console.log("site.url=http://localhost:4000");
  console.log("site.baseurl=/f23");
  console.log("site.data.navigation.home.url=/");
  console.log("site.data.navigation.home.baseurl=/");
  console.log("home_url=/");
  console.log("home_url_final=https://ucsb-cs24.github.io/");
</script>



<script>
  console.log("offering_url=/");
  console.log("offering_baseurl=/f23");
  console.log("offering_url_final=/f23/");
  console.log("offering_title=F23");
</script>


<nav class="navbar navbar-expand-lg navbar-light bg-light">

  <a class="navbar-brand" href="https://ucsb-cs24.github.io/">UCSB CS24</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
    <ul class="navbar-nav mr-auto"><li class="nav-item dropdown">
  <a class="nav-link dropdown-toggle" href="#" id="main-dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Resources
  </a>
  <div class="dropdown-menu" aria-labelledby="main-dropdown"><a class="dropdown-item" href="https://ucsb-cs24.github.io/topic_list/">Topics</a><a class="dropdown-item" href="https://ucsb-cs24.github.io/resources_list/">Resources</a></div>
</li><li class="nav-item">
  <a class="nav-link" href="/f23/">
    F23
  </a>
</li>
<li class="nav-item"><a class="nav-link" href="/f23/pa_list/"title="Programming Assignments"data-term="" >PA</a>

</li><li class="nav-item"><a class="nav-link" href="/f23/lab_list/"title="Lab Assignments"data-term="" >Lab</a>

</li><li class="nav-item"><a class="nav-link" href="/f23/info/calendar/"title="Assignment Calendar"data-term="" ><i class='fa fa-calendar' aria-hidden='true'></i>&nbsp;Cal</a>

</li><li class="nav-item dropdown " data-term="">
  <a class="nav-link dropdown-toggle" href="#" id="navbar-offering-specific-dropdown-More" data-toggle="dropdown" aria-haspopup="true"
     aria-expanded="false">More</a>
    <div class="dropdown-menu" aria-labelledby="navbar-offering-specific-dropdown-More"><a class="dropdown-item" href="/f23/info/syllabus/"title="Syllabus"data-term="" >Syllabus</a>

<a class="dropdown-item" href="/f23/info_list/"title="List of General Information Pages"data-term="" >Info Pages</a>

</div>
</li>


<li class="nav-item dropdown " data-term="">
  <a class="nav-link dropdown-toggle" href="#" id="navbar-offering-specific-dropdown-Links" data-toggle="dropdown" aria-haspopup="true"
     aria-expanded="false">Links</a>
    <div class="dropdown-menu" aria-labelledby="navbar-offering-specific-dropdown-Links"><a class="dropdown-item" href="https://gauchospace.ucsb.edu"title="Overall Grade Information"data-term="" >Gauchospace</a>

<a class="dropdown-item" href="https://gradescope.com"title="HW and Lab Grades"data-term="" >GradeScope</a>

<a class="dropdown-item" href="https://piazza.com"title="Q&A Forum"data-term="" >Piazza</a>

</div>
</li>


<li class="nav-item dropdown " data-term="">
  <a class="nav-link dropdown-toggle" href="#" id="navbar-offering-specific-dropdown-Github" data-toggle="dropdown" aria-haspopup="true"
     aria-expanded="false">Github</a>
    <div class="dropdown-menu" aria-labelledby="navbar-offering-specific-dropdown-Github"><a class="dropdown-item" href="https://github.com/ucsb-cs24-f23"data-term="" ><i class='fab fa-github' aria-hidden='true'></i>&nbsp;ucsb-cs24-f23</a>

</div>
</li>


</ul>
  </div>
</nav>


    <div id="content"  class="ui-content">
    




<table>
<tr>

  <td><a href="/f23/lectures/lect03/">Previous Lecture</a></td>
  
<td>lect04</td>

 <td><a href="/f23/lectures/lect05/">Next Lecture</a></td>

</tr>
</table>

 
    <h1 id="code-from-lecture">Code from lecture</h1>

<p><a href="https://github.com/ucsb-cs24-f23/cs24-f23-lectures/tree/main/lect04">https://github.com/ucsb-cs24-f23/cs24-f23-lectures/tree/main/lect04</a></p>

<h1 id="topics">Topics</h1>
<p>Recursion, dynamic memory errors, rule of three!</p>

<h2 id="rule-of-three">Rule of three</h2>
<ul>
  <li>In C++ there is a rule of thumb that states if any of the copy-constructor, copy assignment or destructor are overloaded, the others must be overloaded as well. We’s like to understand the reasoning behind this rule of thumb. We looked at why and how we need to overload the destructor and the copy-constructor in the last class. We’ll focus on the copy assignment operator in this class.</li>
</ul>

<p>The questions we ask are:</p>
<ol>
  <li>What is the behavior of these defaults (taking linked lists as our running example)?</li>
  <li>When and why do we need to overload these?</li>
  <li>What is the outcome we desire to have with the overloaded de’tor, copy con’tor and copy assignment operator for the linked list class?</li>
</ol>

<h2 id="destructor">Destructor</h2>

<p>In general the destructor is called when 
a) a stack object goes out of local scope and has to be removed from memory
b) delete is called on a pointer that is pointing to an object of the class on the heap</p>

<p>Here are two scenarios where the destructor is called</p>

<p>Case 1:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>void foo(){
   LinkedList l1; 
   ....
   ....
   //l1's destructor is called  right after the function returns
}

</code></pre></div></div>
<p>Case 2:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  LinkedList* p = new LinkedList; // This line may be in any function
  .....
  delete p; // This line may be in a function different from where the object was created with new
</code></pre></div></div>

<p>Now suppose we had a linked list object (either on the stack or the heap) that has the following elements</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>l1:1-&gt;2-&gt;5-&gt;null
</code></pre></div></div>
<ul>
  <li>What is the state of memory after l1’s default destructor is called?</li>
  <li>Do you see a problem with the default behavior?</li>
  <li>How would you fix this problem?</li>
</ul>

<h2 id="copy-constructor">Copy constructor</h2>

<p>The default copy constructor copies the values of the member variables of a source object to the objects that is being created.</p>

<p>For we created the following linked list in memory:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>l1:1-&gt;2-&gt;5-&gt;null
</code></pre></div></div>
<p>As far as the compiler is concerened its perfectly valid to create a new object l2 that is the copy of l1 as follows:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LinkedList l2(l1); // l2's copy constructor is called and l1 is passed as a parameter
</code></pre></div></div>
<p>OR</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LinkedList l2 = l1; // l2's copy constructor is called and l1 is passed as a parameter
</code></pre></div></div>

<p>OR we could create the new object on the heap as follows</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LinkedList* p = new LinkedList(l1); 
</code></pre></div></div>

<p>In all the above cases the default copy constructor of the new object is called.</p>

<ul>
  <li>What is the state of memory in each case?</li>
  <li>Do you see a problem with the default behavior? (Talk about shallow vs deep copy)</li>
  <li>How can we fix this problem?</li>
</ul>

<h2 id="copy-assignment-operator">Copy assignment operator</h2>

<p>The default assignment operator works like the copy constructor except it copies values from one existing object to another object that already exists</p>

<p>For we had two linked lists in memory:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>l1:1-&gt;2-&gt;5-&gt;null
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>l2:10-&gt;20-&gt;50-&gt;60-&gt;null
</code></pre></div></div>

<p>The copy assignment operator will be called in all of the following cases:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>l2 = l1; // l2's copy assignment is called and l1 is passed as a parameter
</code></pre></div></div>
<p>OR</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>l2 = l2; //l2's copy assignment is called and l2 is passed as a parameter!
</code></pre></div></div>

<ul>
  <li>What is the state of memory in each case?</li>
  <li>Do you see a problem with the default behavior?</li>
  <li>How can we fix this problem? Describe the desired behavior.</li>
</ul>


    </div><!-- content -->
    

<nav class="navbar navbar-expand-lg navbar-light bg-light footer-navbar ">
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#footer-navbar-NavAltMarkup" aria-controls="footer-navbar-NavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="footer-navbar-NavAltMarkup">
    <div class="navbar-nav">
      <a class="nav-item nav-link" href="https://github.com/ucsb-cs24/f23">github site</a>
      <a class="nav-item nav-link" href="https://github.com/ucsb-cs24/f23/edit/master/_lectures/lect04.md">edit this page on github</a>
      <span class="nav-item travis-ci-status "><a class="nav-link" href="https://travis-ci.org/ucsb-cs24/f23">
	  <img src="https://travis-ci.org/ucsb-cs24/f23.svg?branch=master" alt="Build Status">
	</a>
      </span>
    </div>
  </div>
</nav>

    </div><!-- container -->
  </body>
</html>
